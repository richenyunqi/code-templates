# 素数

## 用暴力方法判断 n 是否为素数

算法的时间复杂度为$O(\sqrt n)$

```cpp
bool isPrime(gg n) {
    if (n < 2) {
        return false;
    }
    for (gg i = 2; i <= (gg)sqrt(n); ++i) {
        if (n % i == 0) {
            return false;
        }
    }
    return true;
}
```

## 用埃氏筛法求解 [2,n) 以内的素数表

算法的时间复杂度为$O(nloglogn)$

```cpp
vector<gg> prime;
bool f[MAX];
void getPrime(gg n) {
    for (gg i = 2; i < n; ++i){
        if (not f[i]) {
            prime.push_back(i);
            for (gg j = i + i; j < n; j += i){
                f[j] = true;
            }
        }
    }
}
```

## 用欧拉筛法求解 [2,n) 以内的素数表

算法的时间复杂度为$O(n)$

```cpp
vector<gg> prime;
bool f[MAX];
void getPrime(gg n) {
    for (gg i = 2; i < n; ++i) {
        if (not f[i]) {
            prime.push_back(i);
        }
        for (gg j = 0; j < prime.size() and i * prime[j] < n; ++j) {
            f[i * prime[j]] = true;
            if (i % prime[j] == 0){
                break;
            }
        }
    }
}
```

## 利用埃氏筛法求解 [2,n) 以内的所有数字的最大质因子

算法的时间复杂度为$O(nloglogn)$

```cpp
// prime[i]存储i的最大质因子
gg prime[MAX];
void getPrime(gg n) {
    prime[1] = 1;
    for (gg i = 2; i < n; ++i) {
        if (prime[i] == 0) {
            prime[i] = i;
            for (gg j = i + i; j < n; j += i) {
                prime[j] = i;
            }
        }
    }
}
```
